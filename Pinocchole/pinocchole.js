const deckOfCards = [

  {
    suit: 'hearts',
    value: 10,
    img: './SVG-cards-1.3/10_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'K',
    img: './SVG-cards-1.3/king_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 10,
    img: './SVG-cards-1.3/10_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'K',
    img: './SVG-cards-1.3/king_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 10,
    img: './SVG-cards-1.3/10_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'K',
    img: './SVG-cards-1.3/king_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 10,
    img: './SVG-cards-1.3/10_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'K',
    img: './SVG-cards-1.3/king_of_hearts.svg'
  },
  {
    suit: 'hearts',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_hearts.svg'
  },

  {
    suit: 'diamonds',
    value: 10,
    img: './SVG-cards-1.3/10_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'K',
    img: './SVG-cards-1.3/king_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 10,
    img: './SVG-cards-1.3/10_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'K',
    img: './SVG-cards-1.3/king_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 10,
    img: './SVG-cards-1.3/10_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'K',
    img: './SVG-cards-1.3/king_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 10,
    img: './SVG-cards-1.3/10_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'K',
    img: './SVG-cards-1.3/king_of_diamonds.svg'
  },
  {
    suit: 'diamonds',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_diamonds.svg'
  },

  {
    suit: 'clubs',
    value: 10,
    img: './SVG-cards-1.3/10_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'K',
    img: './SVG-cards-1.3/king_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 10,
    img: './SVG-cards-1.3/10_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'K',
    img: './SVG-cards-1.3/king_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 10,
    img: './SVG-cards-1.3/10_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'K',
    img: './SVG-cards-1.3/king_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 10,
    img: './SVG-cards-1.3/10_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'K',
    img: './SVG-cards-1.3/king_of_clubs.svg'
  },
  {
    suit: 'clubs',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_clubs.svg'
  },

  {
    suit: 'spades',
    value: 10,
    img: './SVG-cards-1.3/10_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'K',
    img: './SVG-cards-1.3/king_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 10,
    img: './SVG-cards-1.3/10_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'K',
    img: './SVG-cards-1.3/king_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 10,
    img: './SVG-cards-1.3/10_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'K',
    img: './SVG-cards-1.3/king_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 10,
    img: './SVG-cards-1.3/10_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'J',
    img: './SVG-cards-1.3/jack_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'Q',
    img: './SVG-cards-1.3/queen_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'K',
    img: './SVG-cards-1.3/king_of_spades.svg'
  },
  {
    suit: 'spades',
    value: 'A',
    img: './SVG-cards-1.3/ace_of_spades.svg'
  },
];
// calling card placers from html page
const opponentsCards = document.getElementById('opHand');
const opponentsPartner1 = document.getElementById('opPH1');
const opponentsPartner2 = document.getElementById('opPH2');
const opponentsPartner3 = document.getElementById('opPH3');
const opponentsPartner4 = document.getElementById('opPH4');
const playersCards = document.getElementById('plHand');
const playersPartner1 = document.getElementById('plPh1');
const playersPartner2 = document.getElementById('plPh2');
const playersPartner3 = document.getElementById('plPh3');
const playersPartner4 = document.getElementById('plPh4');
const dButton = document.getElementById('deal');
const bidButton = document.getElementById('bid');
const pass = document.getElementById('pass');
const spaButton = document.getElementById('spa');
const diaButton = document.getElementById('diam');
const hearButton = document.getElementById('hear');
const cluButton = document.getElementById('clu');
const declaredTrump = document.getElementById('trump');
const playerScoreElem = document.getElementById('pscore');
const opponentScoreElem = document.getElementById('oscore');
const fieldDrop = document.getElementById('field');
const saveNeededElem = document.getElementById('bringBack');
const whoseBidElem = document.getElementById('bidder');

let mandatoryBid
let playerScore = 0;
let opponentScore = 0;
let proposedbid = 0;
let pointsNeeded = 0;
let whoHasTheBid = ''
playerScoreElem.textContent = playerScore;
opponentScoreElem.textContent = opponentScore;
saveNeededElem.textContent = pointsNeeded;
whoseBidElem.textContent = whoHasTheBid;


// shuffle deck
// shuffler *
const shuffleArray = (array) => {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    const temp = array[i];
    array[i] = array[j];
    array[j] = temp;
  }
  return array
};

let myDeck = shuffleArray(deckOfCards)

// deal order array
let opponentsDealOrder = ['playersPartner1', 'opponentsPartner1', 'playersHand', 'opponentsHand', 'playersPartner2', 'opponentsPartner2', 'playersHand', 'opponentsHand', 'playerPartner3', 'opponentsPartner3', 'playersHand', 'opponentsHand', 'playersPartner4', 'opponentsPartner4', 'playersHand', 'opponentsHand'];
let playersDealOrder = ['opponentsPartner1', 'playersPartner1', 'opponentsHand', 'playersHand', 'opponentsPartner2', 'playersPartner2', 'opponentsHand', 'playersHand', 'opponentsPartner3', 'playersPartner3', 'opponentsHand', 'playersHand', 'opponentsPartner4', 'playersPartner4', 'opponentsHand', 'playersHand'];

// function for which deal order array to follow
function whosDeal() {
  if (randomIndex(whoseTurn) === 'playersDeal') {
    return playersDealOrder
  } else {
    return opponentsDealOrder
  }

}

// makebutton with eventlistner to run create deal cards
dButton.addEventListener('click', createDealCards);


// find deal order

const whoseTurn = ['playersDeal', 'opponentsDeal', 'playersDeal', 'opponentsDeal', 'playersDeal', 'opponentsDeal', 'playersDeal', 'opponentsDeal'];
function randomIndex(arr) {
  for (let i = 0; i < arr.length; i++) {
    const randomItem = Math.floor(Math.random() * arr.length)
    return arr[randomItem]
  }
}
// console.dir(randomIndex(whosDeal))

// console.log(whosDeal())

// empty arrays for holding cards
let myPlayersCards = [];
let myPlayersPartner1 = [];
let myPlayersPartner2 = [];
let myPlayersPartner3 = [];
let myPlayersPartner4 = [];
let myOpponentsCards = [];
let myOpponentsPartner1 = [];
let myOpponentsPartner2 = [];
let myOpponentsPartner3 = [];
let myOpponentsPartner4 = [];
let fieldArr = [];

//  function *
function createDealCards(event) {
  // appending cards to page
  if (randomIndex(whoseTurn) === 'opponentsDeal') {
    while (myDeck.length) {
      myPlayersCards.push(myDeck.shift())
      myOpponentsCards.push(myDeck.shift())
      myPlayersPartner1.push(myDeck.shift())
      myOpponentsPartner1.push(myDeck.shift())
      myPlayersCards.push(myDeck.shift())
      myOpponentsCards.push(myDeck.shift())
      myPlayersPartner2.push(myDeck.shift())
      myOpponentsPartner2.push(myDeck.shift())
      myPlayersCards.push(myDeck.shift())
      myOpponentsCards.push(myDeck.shift())
      myPlayersPartner3.push(myDeck.shift())
      myOpponentsPartner3.push(myDeck.shift())
      myPlayersCards.push(myDeck.shift())
      myOpponentsCards.push(myDeck.shift())
      myPlayersPartner4.push(myDeck.shift())
      myOpponentsPartner4.push(myDeck.shift())
    }
  }
  displayCards(myPlayersCards, playersCards)
  displayCards(myOpponentsCards, opponentsCards)
  displayCards(myPlayersPartner1, playersPartner1)
  displayCards(myOpponentsPartner1, opponentsPartner1)
  displayCards(myPlayersPartner2, playersPartner2)
  displayCards(myOpponentsPartner2, opponentsPartner2)
  displayCards(myPlayersPartner3, playersPartner3)
  displayCards(myOpponentsPartner3, opponentsPartner3)
  displayCards(myPlayersPartner4, playersPartner4)
  displayCards(myOpponentsPartner4, opponentsPartner4)

}
function displayCards(arr, section) {
  for (let j = 0; j < arr.length; j++) {
    //make components of every card
    let myCard = document.createElement('div');
    let myFront = document.createElement('div');
    let myBack = document.createElement('div');
    let myFace = document.createElement('img');

    myFace.src = arr[j].img

    myCard.classList.add('card');
    myCard.setAttribute('draggable', 'true');
    myFront.classList.add('card_face', 'card_face--front');
    myBack.classList.add('card_face', 'card_face--back');

    myFront.append(myFace);
    myCard.append(myFront);
    myCard.append(myBack);
    let cards = document.querySelectorAll('.card');
    cards.forEach((card) => {
      card.addEventListener('dragstart', () => {
        setTimeout(() => card.classList.add('dragging'), 0);
      });
      card.addEventListener('dragend', () => card.classList.remove('dragging'))
    });
    section.append(myCard);

    if (arr === myOpponentsCards) {
      myCard.classList.add('is-flipped')
      myCard.classList.add(`card-${j}`)
    }
    if (arr === myPlayersCards) {
      myCard.classList.add(`card-${j}`)
    }
  }
}

//handle the drag and drop////////////////////////////////////////////////
const doSort = (ev) => {
  //we dont want the standard dragover behavior
  ev.preventDefault();
  //get a reference to the item dragged
  const draggingItem = playersCards.querySelector('.dragging');
  //make a list of all the cards in the players hand except the one being dragged
  //make that list an array to look down with the ... operator
  const siblings = [...playersCards.querySelectorAll('.card:not(.dragging)')];
  //find the sibling closest to the mouseover ev data, which is the dragItem
  //this will be who we insert the dragItem before
  let nextSibling = siblings.find(sibling => {
    return (ev.clientX - 436) <= (sibling.offsetLeft);
  });
  //All the positioning info for the card is in a class 'card-0x' in css
  //so Have to change the class of the dropped item and the rest of the cards
  draggingItem.classList.replace(draggingItem.classList[1], nextSibling.classList[1]);
  //now change all the cards' class info accordingly
  const kids = playersCards.children;
  for (let i = 0; i < kids.length; i++) {
    kids[i].classList.replace(kids[i].classList[1], `card-${i}`);
  }
  //insert the dragItem before the nextSibling
  playersCards.insertBefore(draggingItem, nextSibling);
}
playersCards.addEventListener('dragover', doSort);
playersCards.addEventListener('dragenter', ev => ev.preventDefault());
// new area

playersCards.addEventListener('dragover', dStart);
playersPartner1.addEventListener('dragover', dStart);
playersPartner2.addEventListener('dragover', dStart);
playersPartner3.addEventListener('dragover', dStart);
playersPartner4.addEventListener('dragover', dStart);
fieldDrop.addEventListener('drop', nDrop);
fieldDrop.addEventListener('drop', dDrop);

// dropping cards to middle site
// using to drag playing cards into playing field

function dStart(event) {
  card = event.target;
  console.dir(card)
  // this.
}
function nDrop(event) {
  event.preventDefault();
}
function dDrop(event) {
  event.preventDefault();
  event.target.appendChild(card);
  if (event.target.className === 'field') {
    fieldArr.push(card)
  }
}

let myMeld = new Map()


spaButton.addEventListener('click', declaredTrumpHandler)

cluButton.addEventListener('click', declaredTrumpHandler)

hearButton.addEventListener('click', declaredTrumpHandler)

diaButton.addEventListener('click', declaredTrumpHandler)

// function to choose trump for player
function declaredTrumpHandler(ev) {
  let ourTrump = ''
  if (ev.target === spaButton) {
    ourTrump = 'spades'
    declaredTrump.textContent = ourTrump
  }
  if (ev.target === diaButton) {
    ourTrump = 'diamonds'
    declaredTrump.textContent = ourTrump
  }
  if (ev.target === hearButton) {
    ourTrump = 'hearts'
    declaredTrump.textContent = ourTrump
  }
  if (ev.target === cluButton) {
    ourTrump = 'clubs'
    declaredTrump.textContent = ourTrump
  }

  // console.log(declaredTrump)
  return
}



// declaredTrump.addEventListener('click', declaredTrumpHandler);

// function for identifying runs in chosen TRUMP only**
function trumpRuns(hand, map) {

  let aces = hand.filter((card) => card.value === 'A')
  let tens = hand.filter((card) => card.value === 10)
  let kings = hand.filter((card) => card.value === 'K')
  let queens = hand.filter((card) => card.value === 'Q')
  let jacks = hand.filter((card) => card.value === 'J')


  // run in spades
  if (ourTrump === 'spades') {
    let aSp = aces.filter((card) => card.suit === 'spade')
    let tenSp = tens.filter((card) => card.suit === 'spade')
    let kSp = kings.filter((card) => card.suit === 'spade')
    let qSp = queens.filter((card) => card.suit === 'spade')
    let jSp = jacks.filter((card) => card.suit === 'spade')

    let runArray = new Array(aSp.length, tenSp.length, kSp.length, qSp.length, jSp.length)

    runArray.sort()
    map.set('run', runArray[0])
  }
  // run in hearts
  else if (ourTrump === 'hearts') {
    let aHrt = aces.filter((card) => card.suit === 'heart')
    let tenHrt = tens.filter((card) => card.suit === 'heart')
    let kHrt = kings.filter((card) => card.suit === 'heaHrt')
    let qHrt = queens.filter((card) => card.suit === 'heaHrt')
    let jHrt = jacks.filter((card) => card.suit === 'heaHrt')
    runArray = new Array(aHrt.length, tenHrt.length, kHrt.length, qHrt.length, jHrt.length)

    runArray.sort()
    map.set('run', runArray[0])

  }
  // run in diamonds
  else if (ourTrump === 'diamonds') {

    let aDia = aces.filter((card) => card.suit === 'diamond')
    let tenDia = tens.filter((card) => card.suit === 'diamond')
    let kDia = kings.filter((card) => card.suit === 'diamond')
    let qDia = queens.filter((card) => card.suit === 'diamond')
    let jDia = jacks.filter((card) => card.suit === 'diamond')

    runArray = new Array(aDia.length, tenDia.length, kDia.length, qDia.length, jDia.length)

    runArray.sort()
    map.set('run', runArray[0])

  }
  // run in clubs
  else if (ourTrump === 'clubs') {

    let aClb = aces.filter((card) => card.suit === 'club')
    let tenClb = tens.filter((card) => card.suit === 'club')
    let kClb = kings.filter((card) => card.suit === 'club')
    let qClb = queens.filter((card) => card.suit === 'club')
    let jClb = jacks.filter((card) => card.suit === 'club')

    runArray = new Array(aClb.length, tenClb.length, kClb.length, qClb.length, jClb.length)

    runArray.sort()
    map.set('run', runArray[0])

  }
  else {
    return
  }
}

// console.log(trumpRuns)
// mandatory bid function*
function mandatory150(runArray, map) {
  for (let i = 0; i < runArray.length; i++) {

    if (map.run.spades === 2) {
      mandatoryBid = true
    }
    else if (map.run.hearts === 2) {
      mandatoryBid = true
    }
    else if (map.run.clubs === 2) {
      mandatoryBid = true
    }
    else if (map.run.diamonds === 2) {
      mandatoryBid = true
    }
    else {
      return
    }
  }
}

// function for finding marriages *
function findMarriages(hand, map) {
  let kings = hand.filter((card) => card.value === 'K')
  let queens = hand.filter((card) => card.value === 'Q')


  // marriage in spades -
  let kSp = kings.filter((card) => card.suit === 'spade')
  let qSp = queens.filter((card) => card.suit === 'spade')

  let marriageArray = new Array(kSp.length, qSp.length)

  marriageArray.sort()
  map.set('marriage', marriageArray[0])


  // marriage in diamonds -
  let kDia = kings.filter((card) => card.suit === 'diamond')
  let qDia = queens.filter((card) => card.suit === 'diamond')

  marriageArray = new Array(kDia.length, qDia.length)


  marriageArray.sort()
  map.set('marriage', marriageArray[0])


  // marriage in hearts -
  let kHrt = kings.filter((card) => card.suit === 'heart')
  let qHrt = queens.filter((card) => card.suit === 'heart')

  marriageArray = new Array(kHrt.length, qHrt.length)

  marriageArray.sort()
  map.set('marriage', marriageArray[0])


  // marriage in clubs -
  let kClb = kings.filter((card) => card.suit === 'club')
  let qClb = queens.filter((card) => card.suit === 'club')

  marriageArray = new Array(kClb.length, qClb.length)

  marriageArray.sort()
  map.set('marriage', marriageArray[0])

}

// console.log(findMarriages)


// function to find kings,queens,jacks and aces around *
function findRounds(hand, map) {
  let kings = hand.filter((card) => card.value === 'K')
  let queens = hand.filter((card) => card.value === 'Q')
  let jacks = hand.filter((card) => card.value === 'J')
  let aces = hand.filter((card) => card.value === 'A')

  // kings around -
  let kSp = kings.filter((card) => card.suit === 'spade')
  let kDia = kings.filter((card) => card.suit === 'diamond')
  let kClb = kings.filter((card) => card.suit === 'club')
  let kHrt = kings.filter((card) => card.suit === 'heart')

  let kingArray = new Array(kSp.length,
    kDia.length, kClb.length, kHrt.length)

  kingArray.sort()
  map.set('kingsRound', kingArray[0])

  // queens around -
  let qSp = queens.filter((card) => card.suit === 'spade')
  let qDia = queens.filter((card) => card.suit === 'diamond')
  let qClb = queens.filter((card) => card.suit === 'club')
  let qHrt = queens.filter((card) => card.suit === 'heart')

  let queenArray = new Array(qSp.length,
    qDia.length, qClb.length, qHrt.length)

  queenArray.sort()
  map.set('queensRound', queenArray[0])

  // jacks around -
  let jSp = jacks.filter((card) => card.suit === 'spade')
  let jDia = jacks.filter((card) => card.suit === 'diamond')
  let jClb = jacks.filter((card) => card.suit === 'club')
  let jHrt = jacks.filter((card) => card.suit === 'heart')

  let jackArray = new Array(jSp.length,
    jDia.length, jClb.length, jHrt.length)

  jackArray.sort()
  map.set('jacksRound', jackArray[0])

  // aces around -
  let aSp = aces.filter((card) => card.suit === 'spade')
  let aDia = aces.filter((card) => card.suit === 'diamond')
  let aClb = aces.filter((card) => card.suit === 'club')
  let aHrt = aces.filter((card) => card.suit === 'heart')

  let aceArray = new Array(aSp.length,
    aDia.length, aClb.length, aHrt.length)

  aceArray.sort()
  map.set('acesRound', aceArray[0])



}

// console.log(findRounds)

// Mandatory 100 Aces
function mandatory100(aceArray, map) {
  for (let i = 0; i < aceArray.length; i++) {
    if (map.acesRound === 2) {
      mandatoryBid = true
    }
    else {
      return
    }
  }
  con
}

// function to find pinocchole *
function findPinocchole(hand, map) {
  let queens = hand.filter((card) => card.value === 'Q')
  let jacks = hand.filter((card) => card.value === 'J')

  let qSp = queens.filter((card) => card.suit === 'spade')
  let jDia = jacks.filter((card) => card.suit === 'diamond')

  let pinoccholeArray = new Array(qSp.length, jDia.length)

  pinoccholeArray.sort()
  map.set('pinocchole', pinoccholeArray[0])


}
// console.log(findPinocchole)
// function for counting meld to be used before and after bidding
function meldCount(hand, score) {
  switch (trumpRuns(hand)) {
    case 1:
      score += 15
      findRounds()
      break;
    case 2:
      score += 150
      mandatory150()
      break;
    default:
      score += 0
  }
  switch (acesRound(hand)) {
    case 1:
      score += 10
      findRounds()
      break;
    case 2:
      score += 150
      mandatory100()
      break;
    default:
      score += 0
  }
  switch (kingsRound(hand)) {
    case 1:
      score += 8
      findRounds()
      break;
    case 2:
      score += 80
      findRounds()
      break;
    default:
      score += 0
  }
  switch (queensRound(hand)) {
    case 1:
      score += 6
      findRounds()
      break;
    case 2:
      score += 80
      findRounds()
      break;
    default:
      score += 0
  }
  switch (jacksRound(hand)) {
    case 1:
      score += 4
      findRounds()
      break;
    case 2:
      score += 40
      findRounds()
      break;
    default:
      score += 0
  }
  switch (findPinocchole(hand)) {
    case 1:
      score += 4
      findPinocchole()
      break;
    case 2:
      score += 30
      findPinocchole()
      break;
    case 3:
      score += 90
      findPinocchole()
      break;
    case 4:
      score += 350
      findPinocchole()
      break;
    default:
      score += 0
  }
  switch (findMarriages(hand)) {
    case 1:
      score += 2
      findMarriages()
      break;
    case 2:
      score += 4
      findMarriages()
      break;
    case 3:
      score += 6
      findMarriages()
      break;
    case 4:
      score += 8
      findMarriages()
      break;
    default:
      score += 0
  }

}
// function for counting trump meld after bidding complete
function trumpCount(meldCount, hand, score) {

  for (let i = 0; i < meldCount.length; i++) {
    if (hand === runInTrump + marriages(hearts, clubs, spades, diamonds)) {
      score += 35
    }
    if (hand === (runInTrump + marriageInTrump * 1)) {
      score += 19
    }
    if (hand === (runInTrump + (marriageInTrump * 2))) {
      score += 23
    }
    if (hand === (runInTrump + (marriageInTrump * 3))) {
      score += 27
    }
    if (marriageInTrump === 1) {
      score += 4
    }
    if (marriageInTrump === 2) {
      score += 8
    }
    if (marriageInTrump === 3) {
      score += 12
    }
    if (hand === marriages(hearts, clubs, spades, diamonds)) {
      score += 24
    }
    else {
      return
    }
  }
}
// slider for the player to submit bid
let slider = document.getElementById('myRange');
let output = document.getElementById('display');
output.innerHTML = slider.value;

slider.oninput = function () {
  output.innerHTML = this.value;
}


// random array for the opponent to choose bid
randomArr = ['5', '10', '15', '20', '25', '30']
// bid array for matching with the hands to determine bids and what need to be brought back
bidArray = ['50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '65', '70', '75', '80', '85', '90', '95', '100', '110', '120', '130', '140', '150', '160', '170', '180', '190', '200', '210', '220', '230', '240', '250', '260', '270', '280', '290', '300', '310', '320', '330', '340', '350']
let opponentsBid = 0;
// random function for the opponents/computers bid
function opponentsChoice(arr) {
  const totalItems = randomArr.length
  const randomItem = Math.floor(Math.random() * totalItems)
  opponentsBid = arr[randomItem] + meldCount(opponentsCards)
  return  opponentsBid
}
// button for passing the bid on opponents deal or after opponent out bids you
pass.addEventListener('click', bidHandler);
// sliders eventlistener on change
slider.addEventListener('change', bidHandler)


let playersBid = slider.value;

// function for choosing a trump suit
function pickATrump(){
  const hisSpades = opponentsCards.filter((card)=> card.suit === 'spades')
  const hisHearts = opponentsCards.filter((card)=> card.suit === 'hearts')
  const hisClubs = opponentsCards.filter((card)=> card.suit === 'clubs')
  const hisDiamonds = opponentsCards.filter((card)=> card.suit === 'diamonds')
 const seek = [hisSpades, hisHearts, hisClubs, hisDiamonds]
 const marriage = ['K', 'Q'];
 const run = ['A', 10, 'K', 'Q', 'J'];
  for (let i = 0; i < seek.length; i++){
    if (seek[i].includes(marriage)){
      if (seek[i].includes(run)){
        if (seek[i].length >= 8){
          let aces = seek[i].filter((card)=> card.value = 'A')
          let tens = seek[i].filter((card) => card.value = 10)
          if ((aces.length + tens.length) >= 4 ){
            console.log('true')
            return true
          }
        }
      }
    }

  }
}

// bid is mandatory for game to start. If everyone passes the dealer has bid by default
function bidHandler() {
  opponentsBid = opponentsChoice(randomArr);
  whoseBidElem.textContent = opponentsBid
  for (let i = 0; i < bidArray.length; i++) {
    if (playersBid > opponentsBid) {
      return `${playersBid} player`
    }
    if (playersBid === pass){
      return `${opponentsBid} opponent`
    }
    if (opponentsBid === pass){
      return `${playersBid} player`
    }
    else {
      return `${opponentsBid} opponent`
    }
  }
  return whoHasTheBid
}
// console.log(playersBid)
console.dir(output)


// console.log(whoHasTheBid)